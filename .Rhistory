dev.cur()
setwd("C:/Study/Coursera/1 Data-Science/2 RStudio/5 Class 5/2 week2/RepData_PeerAssessment1")
dataAct <- read.csv("activity.csv")
dataPerDay <- aggregate(steps ~ date, dataAct, sum)
library(ggplot2)
g <- ggplot(dataPerDay, aes(x=steps))
q <- g + geom_histogram(binwidth = 1000) +
xlab("steps per day")
plot(q)
g <- ggplot(dataPerDay, aes(x=steps))
q <- g + geom_histogram(binwidth = 1000) +
xlab("Total steps per day") +
ggtitle("Histogram of the total number of steps taken each day")
plot(q)
mean(dataPerDay$steps)
median(dataPerDay$steps)
head(dataPerDay)
head(dataAct)
str(dataAct)
head(dataAct$date)
dataAveDaily <- subset(dataAct, date == "1")
dataAveDaily <- aggregate(steps ~ interval, dataAct, mean)
head(dataAveDaily)
g <- ggplot(dataAveDaily, aes(x=interval, y=steps))
q <- g +
geom_line() +
xlab("interval") +
ylab("Number of steps") +
ggtitle("Time series plot")
plot(q)
dataAveDaily[which.max(dataAveDaily$steps),1]
head(dataAct)
sum(is.na(dataAct$steps))
str(dataAct)
rm=list(ls())
rm(list=ls())
dataAct <- read.csv("activity.csv")
dataByDate <- aggregate(steps ~ date, dataAct, sum)
head(dataByDate)
mean(dataByDate$steps)
median(dataByDate$steps)
dataByInterval <- aggregate(steps ~ interval, dataAct, mean)
head(dataByInterval)
dataByInterval[which.max(dataByInterval$steps),1]
sum(is.na(dataAct$steps))
head(dataAct)
for (i in dataAct$steps){
print(i)
}
dataAct2 <- dataAct
head(dataAct2)
head(dataByInterval)
for (i in length(dataAct$steps)){
if (dataAct2$steps[i] == NA){
dataAct2$steps[i] <- dataByInterval[dataByInterval$interval == dataAct2$interval[i], 2]
}
}
dataAct2 <- dataAct
for (i in length(dataAct$steps)){
if (is.na(dataAct2$steps[i]){
dataAct2$steps[i] <- dataByInterval[dataByInterval$interval == dataAct2$interval[i], 2]
}
}
for (i in length(dataAct$steps)){
if (is.na(dataAct2$steps[i]){
dataAct2$steps[i] <- dataByInterval[dataByInterval$interval == dataAct2$interval[i], 2]
}
}
for (i in length(dataAct$steps)){
print(i)
}
for (i in 1:length(dataAct$steps)){
print(i)
}
for (i in 1:length(dataAct$steps)){
if (is.na(dataAct2$steps[i]){
dataAct2$steps[i] <- dataByInterval[dataByInterval$interval == dataAct2$interval[i], 2]
}
}
for (i in 1:length(dataAct$steps)){
if (is.na(dataAct2$steps[i]){
dataAct2$steps[i] <- dataByInterval[dataByInterval$interval == dataAct2$interval[i], 2]
}
}
dataAct2 <- dataAct
for (i in 1:length(dataAct$steps)){
if (is.na(dataAct2$steps[i])){
dataAct2$steps[i] <- dataByInterval[dataByInterval$interval == dataAct2$interval[i], 2]
}
}
head(dataAct2)
head(dataByInterval)
dataByDate2 <- aggregate(steps ~ date, dataAct2, sum)
head(dataByDate2)
g <- ggplot(dataByDate2, aes(x=steps))
q <- g + geom_histogram(binwidth = 1000) +
xlab("Total steps per day") +
ggtitle("Histogram of the total number of steps taken each day")
plot(q)
mean(dataByDate2$steps)
median(dataByDate2$steps)
mean(dataByDate$steps)
median(dataByDate$steps)
tail(dataAct2)
tail(dataByInterval)
dataByDate2 <- aggregate(steps ~ date, dataAct2, sum)
mean(dataByDate2$steps)
median(dataByDate2$steps)
mean(dataByDate$steps)
median(dataByDate$steps)
rm(ls())
rm(list = ls())
dataAct <- read.csv("activity.csv")
dataByDate <- aggregate(steps ~ date, dataAct, sum)
dataByInterval <- aggregate(steps ~ interval, dataAct, mean)
dataByInterval[which.max(dataByInterval$steps),1]
dataAct2 <- dataAct
sum(is.na(dataAct$steps))
for (i in 1:length(dataAct$steps)){
if (is.na(dataAct2$steps[i])){
dataAct2$steps[i] <- dataByInterval[dataByInterval$interval == dataAct2$interval[i], 2]
}
}
dataByDate2 <- aggregate(steps ~ date, dataAct2, sum)
mean(dataByDate2$steps)
median(dataByDate2$steps)
weekdays(dataAct2$date)
weekdays(as.Date(dataAct2$date))
str(as.Date(dataAct2$date))
weekdayOrNot <- weekdays(as.Date(dataAct2$date))
day <- c("Monday","Wednesday","Sunday")
day <- c("Monday","Wednesday","Sunday")
if (day %in% c("Monday","Tuesday","Wednesday","Thursday","Friday")){
day <- "Weekday"
}
else if (day %in% c("Saturday","Sunday")){
day <- "Weekend"
}
day <- c("Monday","Wednesday","Sunday")
if (day %in% c("Monday","Tuesday","Wednesday","Thursday","Friday")){
day <- ("Weekday")
}
else if (day %in% c("Saturday","Sunday")){
day <- ("Weekend")
}
day <- c("Monday","Wednesday","Sunday")
if (day %in% c("Monday","Tuesday","Wednesday","Thursday","Friday")){
day <- ("Weekday")
}
day <- c("Monday","Wednesday","Sunday")
for (i in length(day)){
if (day[i] %in% c("Monday","Tuesday","Wednesday","Thursday","Friday")){
day[i] <- "Weekday"
}
else if (day[i] %in% c("Saturday","Sunday")){
day[i] <- "Weekend"
}
}
day <- c("Monday","Wednesday","Sunday")
for (i in 1:length(day)){
if (day[i] %in% c("Monday","Tuesday","Wednesday","Thursday","Friday")){
day[i] <- "Weekday"
}
else if (day[i] %in% c("Saturday","Sunday")){
day[i] <- "Weekend"
}
}
weekdayOrNot <- weekdays(as.Date(dataAct2$date))
for (i in 1:length(weekdayOrNot)){
if (weekdayOrNot[i] %in% c("Monday","Tuesday","Wednesday","Thursday","Friday")){
weekdayOrNot[i] <- "Weekday"
}
else if (weekdayOrNot[i] %in% c("Saturday","Sunday")){
weekdayOrNot[i] <- "Weekend"
}
}
dataAct2 <- cbind(dataAct2, weekdayOrNot)
head(dataAct2)
dataByInterval2 <- aggregate(steps ~ interval + weekdayOrNot, dataAct2, sum)
head(dataByInterval2)
dataByInterval2
g <- ggplot(dataByInterval2, aes=(x=interval,y=steps))
q <- g +
geom_line() +
facet_grid(weekdayOrNot ~ .)
plot(q)
g <- ggplot(dataByInterval2, aes(x=interval,y=steps))
q <- g +
geom_line() +
facet_grid(weekdayOrNot ~ .)
plot(q)
g <- ggplot(dataByInterval2, aes(x=interval,y=steps))
q <- g +
geom_line() +
facet_grid(. ~ weekdayOrNot)
plot(q)
g <- ggplot(dataByInterval2, aes(x=interval,y=steps))
q <- g +
geom_line() +
facet_grid(weekdayOrNot ~ .)
plot(q)
