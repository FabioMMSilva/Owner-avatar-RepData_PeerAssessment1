rm(list=ls(all=TRUE))

```r
setwd("~/GitHub/RRAssig1")
Act <- read.csv("~/GitHub/RRAssig1/activity.csv")


#Transformations
Act$steps <- as.numeric(Act$steps)

#Remove NA
Act2<-na.omit(Act)

#What is mean total number of steps taken per day?

Steps<-aggregate(Act2$steps, list(Act2$date), sum)
mean(Steps$x) # The mean total number of steps taken per day is 10,766.19
```

```
## [1] 10766.19
```

```r
# 1. Calculate the total number of steps taken per day 

Steps
```

```
##       Group.1     x
## 1  2012-10-02   126
## 2  2012-10-03 11352
## 3  2012-10-04 12116
## 4  2012-10-05 13294
## 5  2012-10-06 15420
## 6  2012-10-07 11015
## 7  2012-10-09 12811
## 8  2012-10-10  9900
## 9  2012-10-11 10304
## 10 2012-10-12 17382
## 11 2012-10-13 12426
## 12 2012-10-14 15098
## 13 2012-10-15 10139
## 14 2012-10-16 15084
## 15 2012-10-17 13452
## 16 2012-10-18 10056
## 17 2012-10-19 11829
## 18 2012-10-20 10395
## 19 2012-10-21  8821
## 20 2012-10-22 13460
## 21 2012-10-23  8918
## 22 2012-10-24  8355
## 23 2012-10-25  2492
## 24 2012-10-26  6778
## 25 2012-10-27 10119
## 26 2012-10-28 11458
## 27 2012-10-29  5018
## 28 2012-10-30  9819
## 29 2012-10-31 15414
## 30 2012-11-02 10600
## 31 2012-11-03 10571
## 32 2012-11-05 10439
## 33 2012-11-06  8334
## 34 2012-11-07 12883
## 35 2012-11-08  3219
## 36 2012-11-11 12608
## 37 2012-11-12 10765
## 38 2012-11-13  7336
## 39 2012-11-15    41
## 40 2012-11-16  5441
## 41 2012-11-17 14339
## 42 2012-11-18 15110
## 43 2012-11-19  8841
## 44 2012-11-20  4472
## 45 2012-11-21 12787
## 46 2012-11-22 20427
## 47 2012-11-23 21194
## 48 2012-11-24 14478
## 49 2012-11-25 11834
## 50 2012-11-26 11162
## 51 2012-11-27 13646
## 52 2012-11-28 10183
## 53 2012-11-29  7047
```

```r
# 2. Make a histogram of the total number of steps taken each day

library (ggplot2)
ggplot(data=Steps,aes(Group.1,x))+geom_histogram(stat="identity", fill="blue", colour="black")+
        xlab("Date")+ylab("Steps per day")+
        theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

![](PA1_assignment_template_RERM_files/figure-html/unnamed-chunk-1-1.png) 

```r
#3. Calculate and report the mean and median of the total number of steps taken per day
library(plyr)
```

```
## Warning: package 'plyr' was built under R version 3.1.3
```

```r
Steps2<- ddply(Act, "date", summarise, mean = mean (steps), median = median(steps))
Steps2
```

```
##          date       mean median
## 1  2012-10-01         NA     NA
## 2  2012-10-02  0.4375000      0
## 3  2012-10-03 39.4166667      0
## 4  2012-10-04 42.0694444      0
## 5  2012-10-05 46.1597222      0
## 6  2012-10-06 53.5416667      0
## 7  2012-10-07 38.2465278      0
## 8  2012-10-08         NA     NA
## 9  2012-10-09 44.4826389      0
## 10 2012-10-10 34.3750000      0
## 11 2012-10-11 35.7777778      0
## 12 2012-10-12 60.3541667      0
## 13 2012-10-13 43.1458333      0
## 14 2012-10-14 52.4236111      0
## 15 2012-10-15 35.2048611      0
## 16 2012-10-16 52.3750000      0
## 17 2012-10-17 46.7083333      0
## 18 2012-10-18 34.9166667      0
## 19 2012-10-19 41.0729167      0
## 20 2012-10-20 36.0937500      0
## 21 2012-10-21 30.6284722      0
## 22 2012-10-22 46.7361111      0
## 23 2012-10-23 30.9652778      0
## 24 2012-10-24 29.0104167      0
## 25 2012-10-25  8.6527778      0
## 26 2012-10-26 23.5347222      0
## 27 2012-10-27 35.1354167      0
## 28 2012-10-28 39.7847222      0
## 29 2012-10-29 17.4236111      0
## 30 2012-10-30 34.0937500      0
## 31 2012-10-31 53.5208333      0
## 32 2012-11-01         NA     NA
## 33 2012-11-02 36.8055556      0
## 34 2012-11-03 36.7048611      0
## 35 2012-11-04         NA     NA
## 36 2012-11-05 36.2465278      0
## 37 2012-11-06 28.9375000      0
## 38 2012-11-07 44.7326389      0
## 39 2012-11-08 11.1770833      0
## 40 2012-11-09         NA     NA
## 41 2012-11-10         NA     NA
## 42 2012-11-11 43.7777778      0
## 43 2012-11-12 37.3784722      0
## 44 2012-11-13 25.4722222      0
## 45 2012-11-14         NA     NA
## 46 2012-11-15  0.1423611      0
## 47 2012-11-16 18.8923611      0
## 48 2012-11-17 49.7881944      0
## 49 2012-11-18 52.4652778      0
## 50 2012-11-19 30.6979167      0
## 51 2012-11-20 15.5277778      0
## 52 2012-11-21 44.3993056      0
## 53 2012-11-22 70.9270833      0
## 54 2012-11-23 73.5902778      0
## 55 2012-11-24 50.2708333      0
## 56 2012-11-25 41.0902778      0
## 57 2012-11-26 38.7569444      0
## 58 2012-11-27 47.3819444      0
## 59 2012-11-28 35.3576389      0
## 60 2012-11-29 24.4687500      0
## 61 2012-11-30         NA     NA
```

```r
#What is the average daily activity pattern?

# 1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) 
# and the average number of steps taken, averaged across all days (y-axis)

Steps3<- ddply(Act2, "interval", summarise, mean = mean(steps))

ggplot(Steps3, aes(interval, mean)) + geom_line() +
        xlab("Interval") + ylab("Average number of steps averaged across all days")+
        scale_x_continuous()
```

![](PA1_assignment_template_RERM_files/figure-html/unnamed-chunk-1-2.png) 

```r
# 2. Which 5-minute interval, on average across all the days in the dataset, 
#contains the maximum number of steps?

library(plyr)
arrange(Steps3, desc(mean)) ## The maximum number of steps is found on interval 835 which in average had 206.17 steps
```

```
##     interval        mean
## 1        835 206.1698113
## 2        840 195.9245283
## 3        850 183.3962264
## 4        845 179.5660377
## 5        830 177.3018868
## 6        820 171.1509434
## 7        855 167.0188679
## 8        815 157.5283019
## 9        825 155.3962264
## 10       900 143.4528302
## 11       810 129.4339623
## 12       905 124.0377358
## 13       910 109.1132075
## 14       915 108.1132075
## 15       920 103.7169811
## 16      1550 102.1132075
## 17      1845  99.4528302
## 18      1545  98.6603774
## 19       925  95.9622642
## 20      1210  94.8490566
## 21      1215  92.7735849
## 22      1205  87.6981132
## 23      1850  86.5849057
## 24      1855  85.6037736
## 25      1840  85.3396226
## 26      1815  85.3207547
## 27      1900  84.8679245
## 28      1555  83.9622642
## 29      1540  82.9056604
## 30      1725  78.9433962
## 31      1905  77.8301887
## 32      1830  77.6981132
## 33      1740  75.0943396
## 34      1810  74.6981132
## 35      1610  74.5471698
## 36      1835  74.2452830
## 37       800  73.3773585
## 38      1720  72.7169811
## 39       745  69.5471698
## 40      1730  68.9433962
## 41       805  68.2075472
## 42      1825  67.7735849
## 43      1255  67.2830189
## 44       930  66.2075472
## 45      1535  65.3207547
## 46      1605  64.1320755
## 47      1200  63.8679245
## 48       615  63.4528302
## 49      1220  63.3962264
## 50      1615  63.1698113
## 51      1600  62.1320755
## 52      1715  61.2264151
## 53      1355  60.8113208
## 54      1625  59.7735849
## 55      1735  59.6603774
## 56      1820  59.2641509
## 57      1155  59.1886792
## 58      1910  58.0377358
## 59      1805  58.0188679
## 60       750  57.8490566
## 61      1620  56.9056604
## 62      1745  56.5094340
## 63      1325  56.4339623
## 64      1705  56.3018868
## 65       755  56.1509434
## 66      1400  55.7547170
## 67       730  55.6792453
## 68       715  54.5094340
## 69      1230  54.4716981
## 70       610  53.7735849
## 71      1345  53.5471698
## 72      1915  53.3584906
## 73      1015  52.6603774
## 74       740  52.2641509
## 75       630  52.1509434
## 76      1405  51.9622642
## 77       725  50.9811321
## 78      1025  50.7924528
## 79      1710  50.7169811
## 80       710  50.5094340
## 81      1225  50.1698113
## 82      1135  49.9811321
## 83       620  49.9622642
## 84       720  49.9245283
## 85       605  49.2641509
## 86       655  49.0377358
## 87      1415  48.6981132
## 88      1530  48.1320755
## 89      1525  47.7547170
## 90      1350  47.3207547
## 91       625  47.0754717
## 92      1700  46.6226415
## 93      1320  46.2452830
## 94      1650  46.2075472
## 95      1150  46.0377358
## 96      1520  45.9622642
## 97      1950  45.6603774
## 98      1645  45.4528302
## 99       935  45.2264151
## 100     1250  45.0566038
## 101     1640  44.6603774
## 102     1145  44.6037736
## 103      555  44.4905660
## 104      705  44.3773585
## 105      735  44.3207547
## 106     1030  44.2830189
## 107      645  44.1698113
## 108      640  44.0188679
## 109     1630  43.8679245
## 110      700  43.8113208
## 111     1455  43.7735849
## 112     1655  43.6792453
## 113     1450  43.6226415
## 114     1410  43.5849057
## 115     1310  43.2641509
## 116     1330  42.7547170
## 117     1010  42.4150943
## 118     1300  42.3396226
## 119     1140  42.0377358
## 120     1430  41.8490566
## 121     1315  40.9811321
## 122     1800  40.6792453
## 123     1000  40.5660377
## 124     1935  40.0188679
## 125     1340  39.9622642
## 126     1305  39.8867925
## 127      550  39.4528302
## 128      635  39.3396226
## 129     1020  38.9245283
## 130     1515  38.8490566
## 131      945  38.7547170
## 132     1635  38.5660377
## 133     1245  37.7358491
## 134     1425  37.5471698
## 135     1755  37.4528302
## 136     1035  37.4150943
## 137      650  37.3584906
## 138     1920  36.3207547
## 139     1505  36.0754717
## 140     1510  35.4905660
## 141     1420  35.4716981
## 142      950  34.9811321
## 143     1750  34.7735849
## 144     1040  34.6981132
## 145     1955  33.5283019
## 146     1130  33.4339623
## 147     2015  33.3396226
## 148     1235  32.4150943
## 149     2050  32.3018868
## 150     1055  31.9433962
## 151      600  31.4905660
## 152     1100  31.3584906
## 153     1940  30.2075472
## 154     1500  30.0188679
## 155     1105  29.6792453
## 156     1120  28.3773585
## 157     1045  28.3396226
## 158     1435  27.5094340
## 159     1930  27.3962264
## 160     2030  27.3018868
## 161     1005  26.9811321
## 162     2020  26.8113208
## 163     1240  26.5283019
## 164     1125  26.4716981
## 165     1445  26.0754717
## 166     1115  25.5471698
## 167     1945  25.5471698
## 168     1335  25.1320755
## 169     1050  25.0943396
## 170      940  24.7924528
## 171     2110  23.4528302
## 172     2035  21.3396226
## 173     1110  21.3207547
## 174     2045  21.3207547
## 175     2025  21.1698113
## 176      955  21.0566038
## 177     1925  20.7169811
## 178     2055  20.1509434
## 179     2000  19.6226415
## 180     2040  19.5471698
## 181     2010  19.3396226
## 182     2115  19.2452830
## 183     2005  19.0188679
## 184      545  18.3396226
## 185     2105  17.2264151
## 186     1440  17.1132075
## 187     2135  16.3018868
## 188      540  16.0188679
## 189     2100  15.9433962
## 190     2130  14.6603774
## 191     2120  12.4528302
## 192     2230   9.7547170
## 193     2225   8.6981132
## 194     2140   8.6792453
## 195     2215   8.5094340
## 196     2150   8.1320755
## 197     2125   8.0188679
## 198     2145   7.7924528
## 199     2220   7.0754717
## 200      535   6.0566038
## 201     2210   4.8113208
## 202     2335   4.6981132
## 203     2255   4.6037736
## 204      430   4.1132075
## 205     2205   3.6792453
## 206      440   3.4905660
## 207      520   3.3207547
## 208     2300   3.3018868
## 209     2340   3.3018868
## 210      450   3.1132075
## 211      510   3.0000000
## 212      525   2.9622642
## 213     2305   2.8490566
## 214     2155   2.6226415
## 215     2330   2.6037736
## 216      410   2.5660377
## 217      515   2.2452830
## 218     2235   2.2075472
## 219       25   2.0943396
## 220      530   2.0943396
## 221      130   1.8301887
## 222        0   1.7169811
## 223      330   1.6226415
## 224     2250   1.6037736
## 225     2325   1.5849057
## 226      505   1.5660377
## 227      250   1.5471698
## 228       45   1.4716981
## 229     2200   1.4528302
## 230      400   1.1886792
## 231      210   1.1320755
## 232      125   1.1132075
## 233      455   1.1132075
## 234     2355   1.0754717
## 235     2320   0.9622642
## 236      255   0.9433962
## 237      405   0.9433962
## 238       35   0.8679245
## 239      445   0.8301887
## 240     2315   0.8301887
## 241      105   0.6792453
## 242      435   0.6603774
## 243     2345   0.6415094
## 244      325   0.6226415
## 245      335   0.5849057
## 246       30   0.5283019
## 247      340   0.4905660
## 248      145   0.3773585
## 249      425   0.3584906
## 250        5   0.3396226
## 251      115   0.3396226
## 252      420   0.3396226
## 253      100   0.3207547
## 254     2240   0.3207547
## 255       50   0.3018868
## 256      150   0.2641509
## 257      235   0.2264151
## 258     2350   0.2264151
## 259      320   0.2075472
## 260      135   0.1698113
## 261      140   0.1698113
## 262       15   0.1509434
## 263      110   0.1509434
## 264       10   0.1320755
## 265       55   0.1320755
## 266      225   0.1320755
## 267     2245   0.1132075
## 268       20   0.0754717
## 269      345   0.0754717
## 270       40   0.0000000
## 271      120   0.0000000
## 272      155   0.0000000
## 273      200   0.0000000
## 274      205   0.0000000
## 275      215   0.0000000
## 276      220   0.0000000
## 277      230   0.0000000
## 278      240   0.0000000
## 279      245   0.0000000
## 280      300   0.0000000
## 281      305   0.0000000
## 282      310   0.0000000
## 283      315   0.0000000
## 284      350   0.0000000
## 285      355   0.0000000
## 286      415   0.0000000
## 287      500   0.0000000
## 288     2310   0.0000000
```

```r
## Imputing missing values

#  1. Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)

summary(Act)        ## The number of missing values in the dataset is 2304
```

```
##      steps                date          interval     
##  Min.   :  0.00   2012-10-01:  288   Min.   :   0.0  
##  1st Qu.:  0.00   2012-10-02:  288   1st Qu.: 588.8  
##  Median :  0.00   2012-10-03:  288   Median :1177.5  
##  Mean   : 37.38   2012-10-04:  288   Mean   :1177.5  
##  3rd Qu.: 12.00   2012-10-05:  288   3rd Qu.:1766.2  
##  Max.   :806.00   2012-10-06:  288   Max.   :2355.0  
##  NA's   :2304     (Other)   :15840
```

```r
# 2. Devise a strategy for filling in all of the missing values in the dataset. 
#The strategy does not need to be sophisticated. For example, you could use 
#the mean/median for that day, or the mean for that 5-minute interval, etc.

impute.mean <- function(x) replace(x, is.na(x), mean(x, na.rm = TRUE)) #replace NA with mean function

dat2 <- ddply(Act, ~ interval, transform, steps = impute.mean(steps)) # Replaces NA with the mean of each interval


# 3. Create a new dataset that is equal to the original dataset but with the missing data filled in.

dat3<-arrange(dat2, date, interval, steps) # reorder to have new datase equal as the original


# 4. Make a histogram of the total number of steps taken each day 

Steps4<-aggregate(dat3$steps, list(dat3$date), sum)
Steps4
```

```
##       Group.1        x
## 1  2012-10-01 10766.19
## 2  2012-10-02   126.00
## 3  2012-10-03 11352.00
## 4  2012-10-04 12116.00
## 5  2012-10-05 13294.00
## 6  2012-10-06 15420.00
## 7  2012-10-07 11015.00
## 8  2012-10-08 10766.19
## 9  2012-10-09 12811.00
## 10 2012-10-10  9900.00
## 11 2012-10-11 10304.00
## 12 2012-10-12 17382.00
## 13 2012-10-13 12426.00
## 14 2012-10-14 15098.00
## 15 2012-10-15 10139.00
## 16 2012-10-16 15084.00
## 17 2012-10-17 13452.00
## 18 2012-10-18 10056.00
## 19 2012-10-19 11829.00
## 20 2012-10-20 10395.00
## 21 2012-10-21  8821.00
## 22 2012-10-22 13460.00
## 23 2012-10-23  8918.00
## 24 2012-10-24  8355.00
## 25 2012-10-25  2492.00
## 26 2012-10-26  6778.00
## 27 2012-10-27 10119.00
## 28 2012-10-28 11458.00
## 29 2012-10-29  5018.00
## 30 2012-10-30  9819.00
## 31 2012-10-31 15414.00
## 32 2012-11-01 10766.19
## 33 2012-11-02 10600.00
## 34 2012-11-03 10571.00
## 35 2012-11-04 10766.19
## 36 2012-11-05 10439.00
## 37 2012-11-06  8334.00
## 38 2012-11-07 12883.00
## 39 2012-11-08  3219.00
## 40 2012-11-09 10766.19
## 41 2012-11-10 10766.19
## 42 2012-11-11 12608.00
## 43 2012-11-12 10765.00
## 44 2012-11-13  7336.00
## 45 2012-11-14 10766.19
## 46 2012-11-15    41.00
## 47 2012-11-16  5441.00
## 48 2012-11-17 14339.00
## 49 2012-11-18 15110.00
## 50 2012-11-19  8841.00
## 51 2012-11-20  4472.00
## 52 2012-11-21 12787.00
## 53 2012-11-22 20427.00
## 54 2012-11-23 21194.00
## 55 2012-11-24 14478.00
## 56 2012-11-25 11834.00
## 57 2012-11-26 11162.00
## 58 2012-11-27 13646.00
## 59 2012-11-28 10183.00
## 60 2012-11-29  7047.00
## 61 2012-11-30 10766.19
```

```r
ggplot(data=Steps4,aes(Group.1,x))+geom_histogram(stat="identity", fill="red", colour="black")+
        xlab("Date")+ylab("Steps per day")+
        theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

![](PA1_assignment_template_RERM_files/figure-html/unnamed-chunk-1-3.png) 

```r
# Calculate and report the mean and median total number of steps taken per day. 

Steps5<- ddply(dat3, "date", summarise, mean = mean (steps), median = median(steps))
Steps5
```

```
##          date       mean   median
## 1  2012-10-01 37.3825996 34.11321
## 2  2012-10-02  0.4375000  0.00000
## 3  2012-10-03 39.4166667  0.00000
## 4  2012-10-04 42.0694444  0.00000
## 5  2012-10-05 46.1597222  0.00000
## 6  2012-10-06 53.5416667  0.00000
## 7  2012-10-07 38.2465278  0.00000
## 8  2012-10-08 37.3825996 34.11321
## 9  2012-10-09 44.4826389  0.00000
## 10 2012-10-10 34.3750000  0.00000
## 11 2012-10-11 35.7777778  0.00000
## 12 2012-10-12 60.3541667  0.00000
## 13 2012-10-13 43.1458333  0.00000
## 14 2012-10-14 52.4236111  0.00000
## 15 2012-10-15 35.2048611  0.00000
## 16 2012-10-16 52.3750000  0.00000
## 17 2012-10-17 46.7083333  0.00000
## 18 2012-10-18 34.9166667  0.00000
## 19 2012-10-19 41.0729167  0.00000
## 20 2012-10-20 36.0937500  0.00000
## 21 2012-10-21 30.6284722  0.00000
## 22 2012-10-22 46.7361111  0.00000
## 23 2012-10-23 30.9652778  0.00000
## 24 2012-10-24 29.0104167  0.00000
## 25 2012-10-25  8.6527778  0.00000
## 26 2012-10-26 23.5347222  0.00000
## 27 2012-10-27 35.1354167  0.00000
## 28 2012-10-28 39.7847222  0.00000
## 29 2012-10-29 17.4236111  0.00000
## 30 2012-10-30 34.0937500  0.00000
## 31 2012-10-31 53.5208333  0.00000
## 32 2012-11-01 37.3825996 34.11321
## 33 2012-11-02 36.8055556  0.00000
## 34 2012-11-03 36.7048611  0.00000
## 35 2012-11-04 37.3825996 34.11321
## 36 2012-11-05 36.2465278  0.00000
## 37 2012-11-06 28.9375000  0.00000
## 38 2012-11-07 44.7326389  0.00000
## 39 2012-11-08 11.1770833  0.00000
## 40 2012-11-09 37.3825996 34.11321
## 41 2012-11-10 37.3825996 34.11321
## 42 2012-11-11 43.7777778  0.00000
## 43 2012-11-12 37.3784722  0.00000
## 44 2012-11-13 25.4722222  0.00000
## 45 2012-11-14 37.3825996 34.11321
## 46 2012-11-15  0.1423611  0.00000
## 47 2012-11-16 18.8923611  0.00000
## 48 2012-11-17 49.7881944  0.00000
## 49 2012-11-18 52.4652778  0.00000
## 50 2012-11-19 30.6979167  0.00000
## 51 2012-11-20 15.5277778  0.00000
## 52 2012-11-21 44.3993056  0.00000
## 53 2012-11-22 70.9270833  0.00000
## 54 2012-11-23 73.5902778  0.00000
## 55 2012-11-24 50.2708333  0.00000
## 56 2012-11-25 41.0902778  0.00000
## 57 2012-11-26 38.7569444  0.00000
## 58 2012-11-27 47.3819444  0.00000
## 59 2012-11-28 35.3576389  0.00000
## 60 2012-11-29 24.4687500  0.00000
## 61 2012-11-30 37.3825996 34.11321
```

```r
#Do these values differ from the estimates from the first part of the assignment?  #Yes the values differ as shown in chart

Steps6<- merge(x = Steps2, y = Steps5, by = "date", all = TRUE) # join the two datasets
str(Steps6)
```

```
## 'data.frame':	61 obs. of  5 variables:
##  $ date    : Factor w/ 61 levels "2012-10-01","2012-10-02",..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ mean.x  : num  NA 0.438 39.417 42.069 46.16 ...
##  $ median.x: num  NA 0 0 0 0 0 0 NA 0 0 ...
##  $ mean.y  : num  37.383 0.438 39.417 42.069 46.16 ...
##  $ median.y: num  34.1 0 0 0 0 ...
```

```r
library(reshape2) # for melt()
melt_Steps6 <- melt(Steps6)
```

```
## Using date as id variables
```

```r
head(melt_Steps6) # so you can see it
```

```
##         date variable    value
## 1 2012-10-01   mean.x       NA
## 2 2012-10-02   mean.x  0.43750
## 3 2012-10-03   mean.x 39.41667
## 4 2012-10-04   mean.x 42.06944
## 5 2012-10-05   mean.x 46.15972
## 6 2012-10-06   mean.x 53.54167
```

```r
ggplot(data=melt_Steps6,aes(date,value))+geom_histogram(stat="identity")+facet_grid(variable~.)+
        xlab("Date")+ylab("Mean and median of steps per day (x = original, y = replaced NA")+
        theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

```
## Warning: Removed 8 rows containing missing values (position_stack).
```

```
## Warning: Removed 8 rows containing missing values (position_stack).
```

![](PA1_assignment_template_RERM_files/figure-html/unnamed-chunk-1-4.png) 

```r
#What is the impact of imputing missing data on the estimates of the total daily number of steps? 

# the number of steps per day increases in some days and there are less emply spaces on the dates

Steps7<- merge(x = Steps, y = Steps4, by = "Group.1", all = TRUE) 
str(Steps7)
```

```
## 'data.frame':	61 obs. of  3 variables:
##  $ Group.1: Factor w/ 61 levels "2012-10-01","2012-10-02",..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ x.x    : num  NA 126 11352 12116 13294 ...
##  $ x.y    : num  10766 126 11352 12116 13294 ...
```

```r
melt_Steps7 <- melt(Steps7)
```

```
## Using Group.1 as id variables
```

```r
ggplot(data=melt_Steps7,aes(Group.1,value))+geom_histogram(stat="identity")+facet_grid(variable~.)+
        xlab("Date")+ylab("Total steps per day")+
        theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

```
## Warning: Removed 8 rows containing missing values (position_stack).
```

![](PA1_assignment_template_RERM_files/figure-html/unnamed-chunk-1-5.png) 

```r
##Are there differences in activity patterns between weekdays and weekends?

# 1. Create a new factor variable in the dataset with two levels - "weekday" and "weekend" indicating whether a given date is a weekday or weekend day.

Act$day <- weekdays(as.Date(Act$date))

library(timeDate)
```

```
## Warning: package 'timeDate' was built under R version 3.1.3
```

```r
dat3$day <- weekdays(as.Date(dat3$date)) #include the day of the week
dat3$IsWeekday<-isWeekday(dat3$date, wday=1:5) # True = weekday, False = weekend

dataPlot3<-aggregate(dat3[, 1], list(dat3$IsWeekday, dat3$interval), mean) # mean for each interval on weekday and weekend

str(dataPlot3)
```

```
## 'data.frame':	576 obs. of  3 variables:
##  $ Group.1: logi  FALSE TRUE FALSE TRUE FALSE TRUE ...
##  $ Group.2: int  0 0 5 5 10 10 15 15 20 20 ...
##  $ x      : num  0.2146 2.2512 0.0425 0.4453 0.0165 ...
```

```r
#  Make a panel plot containing a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) 
#and the average number of steps taken, averaged across all weekday days or weekend days (y-axis). 
#See the README file in the GitHub repository to see an example of what this plot should look like using simulated data.

#To change the facet label name

mf_labeller <- function(var, value){
        value <- as.character(value)
        if (var=="Group.1") { 
                value[value=="TRUE"] <- "Weekday"
                value[value=="FALSE"]   <- "Weekend"
        }
        return(value)
}

# time series plot of the average number of steps per interval across all weekday days and weekend days

ggplot(dataPlot3, aes(Group.2, x)) + geom_line() +facet_grid(Group.1~., labeller=mf_labeller)+
        xlab("Interval") + ylab("Average number of steps averaged across all days")
```

![](PA1_assignment_template_RERM_files/figure-html/unnamed-chunk-1-6.png) 
