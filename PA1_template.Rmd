---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data
```{r, echo=TRUE}

if(!file.exists("activity.csv")){
    unzip("activity.zip") 
}
stepsTakenActivity <- read.csv("activity.csv", header=TRUE)

# Let's take a Peek at our data frame.
head(stepsTakenActivity)

# Let's look at the dimensions at our data frame
dim(stepsTakenActivity)

str(stepsTakenActivity)

# Variable names
names(stepsTakenActivity)

# Translate date variable from a  string type to a date type of a given format
#stepsTakenActivity <- as.Date(stepsTakenActivity$date, format = '%Y-%m-%d')

# Process our Data Frame by finding the total/complete rows 
totalRows <- nrow(stepsTakenActivity)
totalCompleteRows    <-  nrow(na.omit(stepsTakenActivity))

totalRows
totalCompleteRows
```

## What is mean total number of steps taken per day?
We first draw the histogram of the total number of steps taken each day and then,
calculate and report

*  The Mean
*  The Median

of the total of steps taken per day.

```{r, echo=TRUE}

# Take steps variable  as a dependant variable while date is an independane variable
stepsPerDay <- aggregate(steps ~ date, stepsTakenActivity, sum)

hist(stepsPerDay$steps, main = "Total Steps Per Day", col="green", xlab="Number of Steps")
```

Mean for the Total number of steps taken per day:
```{r, echo=TRUE}
mean(stepsPerDay$steps)

```

Median for the Total number of steps taken per day:
```{r, echo=TRUE}
median(stepsPerDay$steps)

```

## What is the average daily activity pattern?
Draw a time series plot of the 5-minute interval and the average number of steps taken, averaged across all days

``` {r, echo=TRUE}
averageInterval <- aggregate(steps ~ interval, stepsTakenActivity, mean, na.rm=TRUE)

# 1.  time series plot (i.e. type = "l")
plot(averageInterval, type = "l", xlab="Intervals", ylab="Average Steps Taken", main="Average Daily Acitivity Pattern")
```

The maximum 5-minute interval on average across all the days in the dataset that contains the maximum number of steps

```{r, echo=TRUE}
# 2. The Maximum 5-minute ininterval
averageInterval$interval[which.max(averageInterval$step)]

```

## Imputing missing values

#### 1.  Total number of missing values:

By using the variables calculated above **totalRows** and **totalCompleteRows** we 
can get the rows that are missing values by subtracting *totalCompleteRows* from *totalRows*.
(*totalRows* - *totalCompleteRows*) 

* Total rows:  `r totalRows`  
* Complete rows:  `r totalCompleteRows` 
* Total Number of missing values: `r totalRows - totalCompleteRows`

###### Alternatively using R in-built is.na functionality.

```{r, echo=TRUE}
activityNA <- sum(is.na(stepsTakenActivity))
activityNA
```




## Are there differences in activity patterns between weekdays and weekends?


#### http://www.cookbook-r.com/Manipulating_data/Summarizing_data/
#### http://www.r-tutor.com/r-introduction/data-frame/data-frame-row-slice
##### http://rstudio-pubs-static.s3.amazonaws.com/19894_7194e7e62e4b4ad09856d0f1c25b0952.html
##### https://rpubs.com/mgmarques/RR_PA1
##### Meta Data: http://rmarkdown.rstudio.com/
####             http://rmarkdown.rstudio.com/html_document_format.html