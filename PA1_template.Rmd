---
title: "PA1_template"
author: "drsh1"
date: "Sunday, April 19, 2015"
output: html_document
---

# Reproducible research PEER ASSESMENT 1



This document was created in order to complete PEER ASSESMENT 1 of Reproducible Research course on COURSERA. The project concerns physical activity data, in particular number of steps taken in different time intervals during the day.



The graphics included were created using ggplot2 and gridExtra packages, therefore those packages must be activated in order to run the code properly.

```{r}
library("ggplot2")
library("gridExtra")
```



## Loading and preprocessing the data
### Task 1: read the data

To start with, I had to obtain and read the data. The suitable .csv file was read into **data frame "activity"** using command:

```{r}
activity <- read.csv("C:/Users/misiek/Desktop/reproducible research/activity.csv")
```

## What is mean total number of steps taken per day?
### Task 2: per day analysis

Nextly, I created new **data frame "agg"** which shows total number of steps taken per day

```{r}
agg <- aggregate(activity$steps, by=list(activity$date), FUN=sum, na.rm=TRUE)
colnames(agg) <- c("date", "steps_per_day")
```

Histogram of total number of steps taken each day

```{r}
qplot(agg$steps_per_day)
```

Mean and median of the total number of steps taken per day

```{r}
mean(agg$steps_per_day, na.rm=TRUE)
median(agg$steps_per_day, na.rm=TRUE)
```



## What is the average daily activity pattern?
### Task 3: per interval analysis

New **data frame "agg2"** is created to show grouping by interval

```{r}
agg2 <- aggregate(activity$steps, by=list(activity$interval), FUN=mean, na.rm=TRUE)
colnames(agg2) <- c("interval", "steps_per_interval_average")
```

Time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

```{r}
ggplot(agg2, aes(interval, steps_per_interval_average)) + geom_line()
```

Then, 5-minute interval, which contains the maximum number of steps was selected (the interval is subsetted from data frame with means not sums of steps per interval taken, therefore it shows highest average, not maximum sum of steps taken, still valid though)

```{r}
subset(agg2[which.max(agg2[,2]),])
```

## Imputing missing values
### Task 4: dealing with NAs

Total number of missing values in the dataset (total number of NAs in all rows)

```{r}
sum(is.na(activity))
```

Nextly, I chose the strategy of filling NAs - I decided to replace them with mean of respective 5-minut interval. I used following code which wrote new data set into new **data frame "activity2"**

```{r}
activity2 <- transform(activity, steps = ifelse(is.na(steps), ave(steps, interval, FUN = function(x) mean(x, na.rm = TRUE)), steps))
```

Again, new **data frame "agg3"** is created to show grouping by date after missing values were imputed

```{r}
agg3 <- aggregate(activity2$steps, by=list(activity2$date), FUN=sum, na.rm=TRUE)
colnames(agg3) <- c("date", "steps_per_day")
```

Histogram of the total number of steps taken each day after missing values were imputed

```{r}
qplot(agg3$steps_per_day)
```

```{r}
mean(agg3$steps_per_day, na.rm=TRUE)
median(agg3$steps_per_day, na.rm=TRUE)
```

Both estimations of parametres and histogram are significantly different after removing NAs. 

## Are there differences in activity patterns between weekdays and weekends?
# Task 5: weekdays analysis

Lastly, I create yet another **data frame "activity3"** for safety reasons

```{r}
activity3 <- activity
```

And then I manipulate the code to add to forementioned data frame columns specifiyng whether a date is week day or weekend day


```{r}
list_of_days <- as.Date(agg[ ,1])
names_of_days <- weekdays(list_of_days)
activity3$wday <- weekdays(as.Date(activity3$date))
d <- ifelse(activity3$wday %in% c('sobota','niedziela'), "weekend", "weekday")
activity3$wknd_or_not <- d
```

Nextly, I divide data frame I am working on into two separate ones: one concerning weekday, one concerning weekends. 

```{r}
activity3weekday <- subset(activity3, wknd_or_not == "weekday")
activity3weekend <- subset(activity3, wknd_or_not == "weekend")
```

New data frames to reflect grouping follow:

```{r}
agg4 <- aggregate(activity3weekday$steps, by=list(activity3weekday$interval), FUN=mean, na.rm=TRUE)
agg5 <- aggregate(activity3weekend$steps, by=list(activity3weekend$interval), FUN=mean, na.rm=TRUE)
colnames(agg4) <- c("interval", "steps_per_interval_average")
colnames(agg5) <- c("interval", "steps_per_interval_average")
```

And finally, summarising plot (grid.arrange function from gridExtra package)

```{r}
p1 <- ggplot(agg4, aes(interval, steps_per_interval_average)) + geom_line() + labs(x = "weekday")
p2 <- ggplot(agg5, aes(interval, steps_per_interval_average)) + geom_line() + labs(x = "weekend")
grid.arrange(p1, p2)
```

It is clear the weekday and weekend patterns significantly differ.
