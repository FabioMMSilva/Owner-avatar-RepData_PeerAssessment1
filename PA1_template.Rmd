---
title: "Reproducible research assignment 1"
author: "Raja"
date: "Saturday, May 16, 2015"
output: html_document
---
```{r, echo=FALSE, results='hide'}
library(dplyr)
```

```{r, echo=FALSE}
temp <- tempfile()
download.file("http://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip", temp)
data <- read.csv(unz(temp, "activity.csv"))
unlink(temp)
```

The total number of steps taken each day
```{r, echo=FALSE}
dataNAZero <- data
dataNAZero$steps[is.na(dataNAZero$steps)] <- 0
dataNAZeroByDay <- tapply(dataNAZero$steps, dataNAZero$date, FUN=sum)
dataNAZeroByDay
```

Histogram of steps per day
```{r, echo=FALSE}
hist(dataNAZeroByDay, main="Histogram of number of steps per day", xlab="No of steps", ylab="Frequency")
```


The MEAN and MEDIAN of number of steps per day
```{r, echo=FALSE}
dataNAZero%>%
group_by(date)%>% 
summarise_each(funs(mean, median), steps)
```


AVERAGE number of steps per interval
```{r, echo=FALSE}
meanByInt<- tapply(dataNAZero$steps, dataNAZero$interval, FUN=mean)
plot(x=dataNAZero$interval[0:288],y=meanByInt, type="l", xlab="Interval", ylab="Average no of steps")
```

TIME interval for max number of mean steps
```{r, echo=FALSE}
meanByInt[meanByInt==max(meanByInt)]
```
Total number of missing values

```{r, echo=FALSE}
sum(is.na(data$steps))
```

Adding Weekend/Weekday to the dataset
```{r, echo=FALSE}
isWeekEnd <-  weekdays(as.Date(dataNAZero$date)) %in% c("Saturday","Sunday") 
dataNAZero$wend <- "Weekday"
dataNAZero$wend[isWeekEnd] <- "Weekend"
weekMean <- with(dataNAZero, tapply(steps, list(interval,wend), mean))
isweekEndMean <- weekMean$wend == "Weekend"
weekMean[isweekEndMean]
par(mfrow=c(2,1))
plot(x=dataNAZero$interval[0:288],y=meanByInt, type="l", xlab="Interval", ylab="Average no of steps")
```
