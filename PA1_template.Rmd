---
title: "Reproducible Research: Peer Assessment 1"
---


## Loading and preprocessing the data
library("dplyr")
library("lattice")

URL <- 'https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip';
zipFile <- 'repdata_data_factivity.zip';
csvFile <- 'activity.csv'

download.file(URL, zipFile, method = 'curl')
unzip(zipFile)

AMD <- read.csv(csvFile, sep = ',', header = TRUE, stringsAsFactors = FALSE)
AMD$date <- as.Date(AMD$date)


## What is mean total number of steps taken per day?
#### 1. Calculate the total number of steps taken per day
stepsPerDay <- AMD %>%
                filter(!is.na(steps)) %>%
                group_by(date) %>%
                summarize(total = sum(steps))
                
#### 2. Make a histogram of the total number of steps taken each day
hist(stepsPerDay$total, main = 'Total Steps per Day', xlab = 'Number of Steps')
  
#### 3. Calculate and report the mean and median of the total number of steps taken per day
##### Mean
round(mean(stepsPerDay$total))

#####Median
median(stepsPerDay$total)


## What is the average daily activity pattern?
#### 1. Make a time series plot (i.e. 𝚝𝚢𝚙𝚎 = "𝚕") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
stepsPerInterval <- aggregate(steps ~ interval, data = AMD, FUN = mean)
                      plot(x = stepsPerInterval$interval, y = stepsPerInterval$steps, type = 'l',
                      main = 'Avg Number of Steps Across All Days', xlab = 'Steps', ylab = 'Interval')

#### 2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
stepsPerInterval[which.max(stepsPerInterval$steps), ]


## Imputing missing values
sum(is.na(AMD$steps))

IntervalAvg <- aggregate(steps ~ interval, FUN = mean, data = AMD)

AMD_Adj <- merge(x = AMD, y = IntervalAvg, by = 'interval')
AMD_Adj$stepsAdj <- ifelse(is.na(AMD_Adj$steps.x), AMD_Adj$steps.y, AMD_Adj$steps.x) 
AMD_Adj <- AMD_Adj[c('interval', 'date', 'stepsAdj')]  



## Are there differences in activity patterns between weekdays and weekends?
