---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r}
activity <- read.csv("activity.csv")
```

## What is mean total number of steps taken per day?
```{r}
# I sum up all steps taken per day
Stepsperday <- aggregate(activity$steps, list(date = activity$date), sum, na.rm=T)

names(Stepsperday) <- c("date", "steps")

# I prepare a histogram of the total steps taken each day 

hist(Stepsperday$steps, col="blue",breaks = c(0,2000,4000,6000, 8000,10000,12000,14000,16000,18000,20000,22000,24000,26000),xlab="Numer of steps per day", 
main="Histogram of the total steps taken each day")

#Calculation of the mean and median values
Daystepsmean <- mean(Stepsperday$steps)
Daystepsmedian <- median(Stepsperday$steps)

#Add mean and median values to histogram
abline(v=Daystepsmean,col="red")
abline(v=Daystepsmedian,col="yellow")
```
## What is the average daily activity pattern?
```{r}
#Calculate average count of steps for each interval
Interstepmean <- aggregate(activity$steps, list(Interval = activity$interval), mean, na.rm=T)
names(Interstepmean) <- c("interval","stpavg")

#Realise plot for relation between Interval and average number of steps 
plot(Interstepmean$interval, Interstepmean$stpavg, type = "l",
xlab = "Intervals", ylab = "Avg number of steps", 
main = "Average steps per 5-min interval", col = "red")
```

## Imputing missing values
```{r}
#The purpose is to substitute each NAs values with mean value for each interval

#Merge tables with original data of activity and data with mean values
MergedActivity <- merge(activity,Interstepmean,by="interval")

names(MergedActivity) <- c("interval","steps", "date", "meansteps" )

#Substitute NA value by mean value for each register
for (i in 1:nrow(MergedActivity)) {
    if (is.na(MergedActivity$steps[i])==TRUE) {
        MergedActivity$steps[i] <- MergedActivity$meansteps[i]
    }
}
#Preparing new histogram  of the total steps taken each day to compare with the first one
Stepsperday2 <- aggregate(MergedActivity$steps, list(date = MergedActivity$date), sum)
names(Stepsperday2) <- c("date", "steps")

hist(Stepsperday2$steps, col="green",breaks = c(0,2000,4000,6000, 8000,10000,12000,14000,16000,18000,20000,22000,24000,26000),xlab="Numer of steps per day", 
     main="Histogram of the total steps taken each day")

#Calculation of the mean and median values
Daystepsmean2 <- mean(Stepsperday2$steps)
Daystepsmedian2 <- median(Stepsperday2$steps)

#Add mean and median values to histogram
abline(v=Daystepsmean2,col="blue")
abline(v=Daystepsmedian2,col="black")
```


## Are there differences in activity patterns between weekdays and weekends?
