---
title: " Reproducable Research Peer-graded Assignment:   Course Project 1"
author: "Sarfaraz Ahmed Qazi"
date: "12/12/2021"
output: html_document
---


This assignment two months of data on human activities from an anonymous individual collected during the months of October and November, 2012. It include the number of steps taken in 5 minute intervals each day.

The dataset "Activity monitoring data (CSV format)" was downloaded from the course website link.
The variables included in this dataset are:

steps: Number of steps taking in a 5-minute interval (missing values are coded as \color{red}{\verb|NA|}NA)
date: The date on which the measurement was taken in YYYY-MM-DD format
interval: Identifier for the 5-minute interval in which measurement was taken

Let us now solve the assignment questions one by one.


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
quietly <- suppressPackageStartupMessages

```



##Q.1 Code for reading in the dataset and/or processing the data

```{r}
library(ggplot2)
library(dplyr)
library(knitr)
library(Hmisc)
if (!file.exists("activity.csv") ) {
        unzip("activity.zip")
}

activity <- read.csv("activity.csv", header = TRUE)
activity$date <- as.POSIXct(activity$date, "%Y-%m-%d",tz="Asia/Urumqi" )
weekday <- weekdays(activity$date)
activity <- cbind(activity,weekday)
summary(activity)
```

## 2. Histogram of the total number of steps taken each day

```{r}
ActivityDailySteps <- aggregate(steps~date, activity, sum)
ggplot(ActivityDailySteps, aes(steps)) + 
  geom_histogram(fill = "pink", color = "black", binwidth = 2000) +
  labs(x = "Daily steps",
  title = "Histogram of the total number of steps taken each day")
```

##3. Mean and median number of steps taken each day

```{r}
DailyMeanSteps <- mean(ActivityDailySteps$steps, na.rm = TRUE)
DailyMedianSteps <- median(ActivityDailySteps$steps, na.rm = TRUE)
DailyMeanSteps
DailyMedianSteps

```

##4. Time series plot of the average number of steps taken


```{r }
DailyAverageActivity <- aggregate(activity$steps, by=list(activity$interval), FUN=mean, na.rm=TRUE)
names(DailyAverageActivity) <- c("interval", "mean")
plot(DailyAverageActivity$interval, DailyAverageActivity$mean, type = "l", col="red", lwd = 2, xlab="Interval", ylab="Average number of steps", main="Time series plot of the average number of steps taken per interval")

```

##5. The 5-minute interval that, on average, contains the maximum number of steps


```{r }
DailyAverageActivity[which.max(DailyAverageActivity$mean), ]$interval
```

##6. Code to describe and show a strategy for imputing missing data

###6.1 Total number of rows with missing (NA) values in the dataset
```{r }
#sum(is.na(activity$steps))
TotalNAs <- length(which(is.na(activity$steps)))
TotalNAs
```

###6.2 Let us impute missing values/NA's 

```{r }
ImputedActivity <- activity
ImputedActivity$steps <- impute(activity$steps, fun=mean)

```




```{r }
Daily_StepsAfterImpute <- aggregate(ImputedActivity$steps, 
                                by = list(Date = ImputedActivity$date), 
                                FUN = "sum")
hist(Daily_StepsAfterImpute$x, col = "red", 
     breaks = 50,
     main = "Histogram-Total number of steps taken each day after missing values are imputed",
     xlab = "Steps per day")

```

```{r }
ImputedActivity<- ImputedActivity%>%
        mutate(DayType= ifelse(weekdays(ImputedActivity$date)=="Saturday" | weekdays(ImputedActivity$date)=="Sunday", "Weekend", "Weekday"))
head(ImputedActivity)

```


```{r }
ggplot(ImputedActivity, aes(x =interval , y=steps, color=DayType)) +
       geom_line() +
       labs(title = "Patteern Difference between Weekdays and Weekend", x = "Interval", y = "Total Number of Steps") +
       facet_wrap(~ DayType, ncol = 2, nrow=1)
```
