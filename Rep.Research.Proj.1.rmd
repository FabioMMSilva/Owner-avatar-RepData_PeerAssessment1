---
title: "Reproducable Research Project 1"
author: "Michael Addonisio"
date: "January 10, 2016"
output: html_document
---


```{r}
#required Libraries
library(dplyr)
library(lubridate)
library(ggplot2)

#define activity data set
df = read.csv("activity.csv")
```

#transform dataset to steps by day
```{r}
steps.per.day = df %>% group_by(date) %>% summarise( sum = sum(steps))
```

#histogram of steps per day 
```{r}
hist(steps.per.day$sum)
```

#mean and median steps per day 
```{r}
mean(steps.per.day$sum, na.rm = TRUE)

median(steps.per.day$sum, na.rm = TRUE)
```

```{r}
steps.per.interval = df %>% na.omit() %>% group_by(interval) %>% summarize(steps = mean(steps))
```

```{r}
plot(steps ~ interval, type = "l", data = steps.per.interval)
```

```{r}
steps.per.interval[which.max(steps.per.interval$steps),]
```

```{r}
sum(is.na(df$steps))
```

#subset na valuess
```{r}
nas = is.na(df$steps)
steps = steps.per.interval$steps
names(steps) = steps.per.interval$interval
df$steps[nas] = steps[as.character(df$interval[nas])]
```

#check if any nas
```{r}
sum(is.na(df$steps))
```

#transform imputed dataset to steps by day 
```{r}
imputed.steps.per.day  = df %>% group_by(date) %>% summarise( sum = sum(steps))
```

#histogram of steps per day 
```{r}
hist(imputed.steps.per.day$sum)
```

#mean and median steps per day 
```{r}
mean(imputed.steps.per.day$sum, na.rm = TRUE)

median(imputed.steps.per.day$sum, na.rm = TRUE)
```

#clean date format and add weekday column
```{r}
df$date = ymd(df$date)
df = df %>% mutate(weekday = ifelse(weekdays(df$date) == "Saturday" | weekdays(df$date) == "Sunday", "Weekend", "Weekday"))
```

#summarise steps per interval per weekday factor
```{r}
steps.per.interval.day = df %>% group_by(interval, weekday) %>% summarise(steps = mean(steps))
```

#plot of steps per interval between weekday and weekend  
```{r}
s = ggplot(steps.per.interval.day, aes(x=interval, y=steps, color = weekday)) + geom_line() + facet_wrap(~weekday, ncol = 1,nrow=2)
s
```